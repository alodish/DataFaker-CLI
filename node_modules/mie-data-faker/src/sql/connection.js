import { createConnection } from 'mysql2';
import * as dotenv from 'dotenv';
dotenv.config();


var connection;
const args = process.argv.slice(2);
const output = (args.includes('-o') || args.includes('--output')) ? args.indexOf('-o') ?? args.indexOf('--output') : false;
const WRITE_TO_DB = output > -1 ? args[output + 1] === 'sql' ? true : false : false;

if (WRITE_TO_DB) {

    var connection = createConnection({
        host: process.env.DB_HOST,
        user: process.env.DB_USER,
        password: process.env.DB_PASSWORD,
        database: process.env.DB_NAME,
    }, (err) => {
        if (err) {
            console.error(err);
        };
    });

    connection.connect((err) => {
        if (err) {
            console.error(`Error connecting to the database: ${err.message}`);
            return;
        }
        console.log('Connected to the database.');
    });
};

export { connection as default }
